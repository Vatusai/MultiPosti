=========================================================================
                     FACEBOOK TOKEN RENEWAL GUIDE
                        MultiPosti Application
=========================================================================

üìã OVERVIEW
-----------
Facebook tokens have different expiration timelines:
‚Ä¢ Short-lived User Token: 1-2 hours
‚Ä¢ Long-lived User Token: 60 days
‚Ä¢ Page Access Token (from long-lived user token): NEVER EXPIRES*

*Page tokens can be invalidated if:
- App password changes
- Page admin permissions are revoked
- App permissions change
- Facebook security updates

üîç WHEN TO RENEW TOKENS
-----------------------
IMMEDIATE RENEWAL NEEDED:
‚Ä¢ Upload fails with "OAuthException" errors
‚Ä¢ Authentication errors in MultiPosti
‚Ä¢ "(#190) Invalid OAuth access token" messages

PREVENTIVE RENEWAL (RECOMMENDED):
‚Ä¢ Every 30-60 days as good practice
‚Ä¢ After changing Facebook app settings
‚Ä¢ After changing page admin permissions
‚Ä¢ Before important upload campaigns

‚ö° QUICK RENEWAL STEPS
---------------------
1. Go to Facebook Graph API Explorer: https://developers.facebook.com/tools/explorer/
2. Select your app: "DigiViolin" (App ID: 1438267127386307)
3. Generate User Token with permissions
4. Convert to Long-lived Token
5. Get Page Token
6. Update MultiPosti credentials

üîß DETAILED RENEWAL PROCESS
---------------------------

STEP 1: ACCESS GRAPH API EXPLORER
‚Ä¢ Open: https://developers.facebook.com/tools/explorer/
‚Ä¢ Login with your Facebook account (page admin)
‚Ä¢ Select your app "DigiViolin" from dropdown

STEP 2: GENERATE USER ACCESS TOKEN
‚Ä¢ Click "Generate Access Token" button
‚Ä¢ Grant permissions when prompted
‚Ä¢ Required permissions for video upload:
  - pages_show_list
  - pages_read_engagement  
  - pages_manage_posts
  - pages_manage_metadata
‚Ä¢ Copy the generated short-lived user token

STEP 3: CONVERT TO LONG-LIVED USER TOKEN
‚Ä¢ In Graph API Explorer, click "Get Token" ‚Üí "Get User Access Token"
‚Ä¢ Click "Extend Access Token" at the bottom
‚Ä¢ Copy the new long-lived token (valid for 60 days)
‚Ä¢ Or use this URL format:
  https://graph.facebook.com/oauth/access_token?client_id=1438267127386307&client_secret=YOUR_APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=SHORT_LIVED_TOKEN

STEP 4: GET PAGE ACCESS TOKEN (NEVER EXPIRES)
‚Ä¢ Using the long-lived user token, make this request:
  GET /me/accounts
‚Ä¢ In Graph API Explorer:
  - Put the long-lived user token in "Access Token" field
  - Query: /me/accounts
  - Click "Submit"
‚Ä¢ Find your page "730666933472073" in the results
‚Ä¢ Copy the "access_token" for your page (this never expires!)

STEP 5: UPDATE MULTIPOSTI CREDENTIALS
‚Ä¢ Open: C:\Users\Fabian Orozco\MultiPosti\credentials\facebook\facebook_token.json
‚Ä¢ Replace the "access_token" field with your new page token
‚Ä¢ Keep the same page_id and app_id
‚Ä¢ Save the file

STEP 6: TEST THE UPDATE
‚Ä¢ Run: python scripts/main.py auth facebook
‚Ä¢ Should show "SUCCESS: Facebook authentication successful!"
‚Ä¢ Test upload: python scripts/main.py upload tutorial.mp4 --platforms facebook --title "Test"

üì± ALTERNATIVE METHOD: USING URLS DIRECTLY
------------------------------------------

1. GET LONG-LIVED USER TOKEN:
https://graph.facebook.com/oauth/access_token?client_id=1438267127386307&client_secret=YOUR_APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=SHORT_LIVED_USER_TOKEN

2. GET PAGE TOKEN:
https://graph.facebook.com/v18.0/me/accounts?access_token=LONG_LIVED_USER_TOKEN

üîê SECURITY BEST PRACTICES
--------------------------
‚Ä¢ Never share your app secret publicly
‚Ä¢ Store tokens securely
‚Ä¢ Revoke old tokens when generating new ones
‚Ä¢ Use HTTPS for all API calls
‚Ä¢ Monitor token usage in Facebook Developer Console

üõ†Ô∏è TROUBLESHOOTING COMMON ISSUES
--------------------------------

ERROR: "Invalid OAuth access token"
SOLUTION: Token has expired, follow renewal steps above

ERROR: "No permission to publish video"
SOLUTION: 
- Check if you're using PAGE token (not user token)
- Verify pages_manage_posts permission is granted
- Confirm you're admin of the page

ERROR: "App not setup for this feature"
SOLUTION:
- Check app is in "Live" mode (not Development)
- Verify app has proper permissions configured

ERROR: "Token validation failed"
SOLUTION:
- Check token isn't truncated when copying
- Ensure no extra spaces in token string
- Try generating new token

üîç HOW TO CHECK TOKEN VALIDITY
------------------------------

METHOD 1: MultiPosti Test
‚Ä¢ Run: python scripts/main.py auth facebook
‚Ä¢ Success = token is valid

METHOD 2: Graph API Explorer
‚Ä¢ Paste token in Graph API Explorer
‚Ä¢ Query: /me (for user token) or /PAGE_ID (for page token)
‚Ä¢ If returns data = token is valid

METHOD 3: Direct API Call
‚Ä¢ GET https://graph.facebook.com/v18.0/me?access_token=YOUR_TOKEN
‚Ä¢ Status 200 = valid, Status 400/401 = invalid

üìÖ RECOMMENDED MAINTENANCE SCHEDULE
----------------------------------
‚Ä¢ MONTHLY: Check token validity
‚Ä¢ QUARTERLY: Renew tokens preventively  
‚Ä¢ IMMEDIATELY: After any Facebook app/page changes
‚Ä¢ BEFORE CAMPAIGNS: Test uploads before important events

üö® EMERGENCY TROUBLESHOOTING
----------------------------
If uploads suddenly stop working:

1. Check Facebook Developer Console for app alerts
2. Verify page admin status hasn't changed
3. Generate new tokens immediately
4. Check for Facebook platform outages
5. Review app permissions in Facebook settings

üìã CURRENT TOKEN INFORMATION
---------------------------
Your MultiPosti setup:
‚Ä¢ App ID: 1438267127386307
‚Ä¢ Page ID: 730666933472073
‚Ä¢ Token Type: Page Access Token (Never expires if from long-lived user token)
‚Ä¢ Current Token: EAAUcGKk4UMMBPWjjKlP6tbx75wLNAWyEUZBzIA...

üí° PRO TIPS
-----------
‚Ä¢ Save tokens in a secure password manager
‚Ä¢ Keep backup tokens (generate multiple page tokens)
‚Ä¢ Document token generation dates
‚Ä¢ Set calendar reminders for preventive renewal
‚Ä¢ Test tokens in Graph API Explorer before updating MultiPosti

üìû SUPPORT RESOURCES
--------------------
‚Ä¢ Facebook Developer Documentation: https://developers.facebook.com/docs/
‚Ä¢ Graph API Explorer: https://developers.facebook.com/tools/explorer/
‚Ä¢ Facebook Developer Community: https://developers.facebook.com/community/
‚Ä¢ MultiPosti Issues: Check console logs for detailed error messages

=========================================================================
Last Updated: August 2024
For MultiPosti v1.0
=========================================================================